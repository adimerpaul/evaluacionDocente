import{b as Q,a as C,Q as V}from"./QTable.f54db903.js";import{_ as k,n,p as m,q as i,t as s,s as e,v as c,W as f,u as d,a$ as u,af as v,S as h,P as y,O as g,a_ as q,V as _,$ as x}from"./index.5655ace8.js";import{Q as b,a as S}from"./format.5d7e1cd8.js";import{Q as E}from"./QList.4d6ee971.js";import{Q as M}from"./QBtnDropdown.9ce69c17.js";import{Q as G}from"./QSpace.6e19b5c9.js";import{Q as B}from"./QForm.b1f16ba9.js";import{Q as D}from"./QPage.e2a93b40.js";import{C as p}from"./ClosePopup.dcec80f0.js";import{g as F}from"./globalStore.d3521491.js";const N={name:"materiaPage",data(){return{store:F(),materiaStatus:"create",loading:!1,materiaShow:!1,materias:[],materia:{name:"",sigla:""},materiaFiltar:"",materiaColumns:[{name:"opcion",label:"Opcion",field:"opcion",align:"left",sortable:!1},{name:"name",label:"Nombre",field:"name",align:"left",sortable:!0},{name:"sigla",label:"Sigla",field:"sigla",align:"left",sortable:!0}]}},mounted(){this.materiasGet()},methods:{materiaEdit(r){this.materiaStatus="edit",this.materiaShow=!0,this.materia=r},materiaDelete(r){this.$q.dialog({title:"Eliminar Materia",message:"\xBFEstas seguro de eliminar esta Materia?",cancel:!0,persistent:!0}).onOk(()=>{this.loading=!0,this.$api.delete(`materia/${r.id}`).then(()=>{this.materiasGet(),this.$q.notify({color:"green-4",textColor:"white",icon:"cloud_done",position:"top",message:"Materia eliminada correctamente"})}).catch(l=>{this.loading=!1,this.$q.notify({color:"red-4",textColor:"white",icon:"cloud_done",position:"top",message:l.response.data.message})})})},materiaCreate(){this.materiaStatus="create",this.materia={name:"",sigla:""},this.materiaShow=!0},materiaSubmit(){this.$q.loading.show(),this.materiaStatus==="create"?this.$api.post("materia",this.materia).then(()=>{this.materiasGet(),this.materiaShow=!1}).finally(()=>{this.$q.loading.hide()}):this.$api.put("materia/"+this.materia.id,this.materia).then(r=>{console.log(r.data),this.materiasGet(),this.materiaShow=!1}).finally(()=>{this.$q.loading.hide()})},materiasGet(){this.materias=[],this.loading=!0,this.$api.get("materia").then(r=>{this.materias=r.data}).finally(()=>{this.loading=!1})}}},I={class:"row"},P={class:"col-12"},T={class:"text-h6"},U={class:"row"},O={class:"col-12 col-md-12"},L={class:"col-12 col-md-12"},R={class:"col-12 col-md-12 text-center q-pt-xs"};function A(r,l,W,j,a,o){return n(),m(D,{class:"q-pa-xs"},{default:i(()=>[s("div",I,[s("div",P,[e(V,{title:"Lista de Materias",loading:a.loading,"rows-per-page-options":[0],columns:a.materiaColumns,rows:a.materias,flat:"",bordered:"",dense:"",filter:a.materiaFiltar},{"header-cell":i(t=>[e(Q,{props:t,class:"bg-primary text-white text-center"},{default:i(()=>[c(f(t.col.label),1)]),_:2},1032,["props"])]),"top-right":i(()=>[e(d,{label:"Registrar Materia",color:"primary","no-caps":"",icon:"add_circle_outline",onClick:o.materiaCreate,dense:""},null,8,["onClick"]),e(d,{flat:"",round:"",icon:"refresh",onClick:o.materiasGet,dense:""},null,8,["onClick"]),e(u,{outlined:"",dense:"",modelValue:a.materiaFiltar,"onUpdate:modelValue":l[0]||(l[0]=t=>a.materiaFiltar=t),label:"Buscar",class:"q-ml-md",clearable:""},{append:i(()=>[e(v,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-opcion":i(t=>[e(C,{props:t,"auto-width":""},{default:i(()=>[e(M,{round:"",dense:"",color:"primary","dropdown-icon":"more_vert",label:"Acciones","no-caps":""},{default:i(()=>[e(E,null,{default:i(()=>[h((n(),m(b,{clickable:""},{default:i(()=>[e(S,{onClick:w=>o.materiaEdit(t.row)},{default:i(()=>[c("Editar")]),_:2},1032,["onClick"])]),_:2},1024)),[[p]]),h((n(),m(b,{clickable:""},{default:i(()=>[e(S,{onClick:w=>o.materiaDelete(t.row)},{default:i(()=>[c("Eliminar")]),_:2},1032,["onClick"])]),_:2},1024)),[[p]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["loading","columns","rows","filter"])])]),e(x,{modelValue:a.materiaShow,"onUpdate:modelValue":l[3]||(l[3]=t=>a.materiaShow=t)},{default:i(()=>[e(y,null,{default:i(()=>[e(g,{class:"row items-center q-pb-none"},{default:i(()=>[s("div",T,f(a.materiaStatus=="create"?"Registrar Materia":"Editar Materia"),1),e(G),h(e(d,{flat:"",icon:"close"},null,512),[[p]])]),_:1}),e(g,null,{default:i(()=>[e(B,{onSubmit:q(o.materiaSubmit,["prevent"]),ref:"myForm"},{default:i(()=>[s("div",U,[s("div",O,[a.materiaStatus=="edit"||a.materiaStatus=="create"?(n(),m(u,{key:0,outlined:"",dense:"",modelValue:a.materia.name,"onUpdate:modelValue":l[1]||(l[1]=t=>a.materia.name=t),label:"Nombre",hint:"",rules:[t=>t.length>0||"El nombre es requerido"]},null,8,["modelValue","rules"])):_("",!0)]),s("div",L,[a.materiaStatus=="edit"||a.materiaStatus=="create"?(n(),m(u,{key:0,outlined:"",dense:"",modelValue:a.materia.sigla,"onUpdate:modelValue":l[2]||(l[2]=t=>a.materia.sigla=t),label:"Sigla",hint:"",rules:[t=>t.length>0||"El nombre es requerido"]},null,8,["modelValue","rules"])):_("",!0)]),s("div",R,[e(d,{loading:a.loading,color:"primary",label:"Guardar",type:"submit","no-caps":"",icon:"save",class:"full-width"},null,8,["loading"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var te=k(N,[["render",A]]);export{te as default};
